<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ú–ò–§–ò</title>
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <link rel="apple-touch-icon" href="icon-512.png" type="image/x-icon">
    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f5f5f5;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        img {
            margin-top: 20px;
            max-width: 50%;
            height: auto;
        }

        h1 {
            margin: 10px 0 5px;
            font-size: 1.8rem;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        h3 {
            margin: 20px 0 10px;
            font-size: 0.9rem;
            font-weight: lighter;
            color: #555;
        }

        .menu-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 5%;
            box-sizing: border-box;
        }

        div.button {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 95%;
            height: 80px;
            background-color: #295BB0;
            margin: 4px 0;
            font-weight: bold;
            font-size: normal;
            color: white;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        div.button:hover {
            background-color: #1e4a8a;
        }

        div.predun_button, div.sportzal_button {
            border-top-left-radius: 24px;
            border-top-right-radius: 24px;
        }

        div.vo_button_zaoch, div.info_button {
            border-bottom-left-radius: 24px;
            border-bottom-right-radius: 24px;
        }

        #backButton {
            background-color: #6c757d;
        }

        #backButton:hover {
            background-color: #5a6268;
        }

        /* –°–∫—Ä—ã—Ç–æ–µ –ø–æ–¥–º–µ–Ω—é */
        #predunmenu {
            display: none;
            width: 100%;
        }

        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Äî –≤–∏–¥–∏–º–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        #mainmenu {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
    </style>
    <script>
         // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç
    const manifest = {
        "name": "–ú–ò–§–ò-3",
        "short_name": "–ú–ò–§–ò-3",
        "description": "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∑–∞–Ω—è—Ç–∏–π –¢–ò –ù–ò–Ø–£ –ú–ò–§–ò, –≥. –õ–µ—Å–Ω–æ–π",
        "start_url": "/",
        "display": "standalone", // ‚Üê –í–ê–ñ–ù–û: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        "background_color": "#ffffff",
        "theme_color": "#295BB0",
        "icons": [
            {
                "src": "icon-192.png",
                "sizes": "192x192",
                "type": "image/png"
            },
            {
                "src": "icon-512.png",
                "sizes": "512x512",
                "type": "image/png"
            }
        ],
        "orientation": "portrait",
        "lang": "ru"
    };

    // –°–æ–∑–¥–∞—ë–º Blob –∏–∑ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
    const stringManifest = JSON.stringify(manifest);
    const blob = new Blob([stringManifest], {type: 'application/json'});
    const manifestURL = URL.createObjectURL(blob);

    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç –≤ head
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = manifestURL;
    document.head.appendChild(link);
        function showpredunmenu() {
            document.getElementById('mainmenu').style.display = 'none';
            document.getElementById('predunmenu').style.display = 'flex';
        }
        function showspomenu() {
            document.getElementById('mainmenu').style.display = 'none';
            document.getElementById('spomenu').style.display = 'flex';
        }
        function showvoochmenu() {
            document.getElementById('mainmenu').style.display = 'none';
            document.getElementById('voochmenu').style.display = 'flex';
        }
        function showvozaochmenu() {
            document.getElementById('mainmenu').style.display = 'none';
            document.getElementById('vozaochmenu').style.display = 'flex';
        }
        function showMainmenu() {
            document.getElementById('predunmenu').style.display = 'none';
            document.getElementById('spomenu').style.display='none';
            document.getElementById('voochmenu').style.display='none';
            document.getElementById('vozaochmenu').style.display='none';
            document.getElementById('mainmenu').style.display = 'flex';
        }

        async function openPDF(pdfUrl, cacheName = 'pdf-cache') {
    let response;

    try {
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–µ–∂—É—é –≤–µ—Ä—Å–∏—é —Å —Å–µ—Ä–≤–µ—Ä–∞
        response = await fetch(pdfUrl, { cache: 'no-cache' });

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        // –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
        const cache = await caches.open(cacheName);
        await cache.put(pdfUrl, response.clone());

        // –û—Ç–∫—Ä—ã–≤–∞–µ–º PDF
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        window.open(url, '_blank');
        return;

    } catch (err) {
        console.warn("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ PDF –æ–Ω–ª–∞–π–Ω:", err.message);

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Å–µ—Ç—å—é ‚Äî –ø—Ä–æ–±—É–µ–º –∫—ç—à
        if (err.message.includes("Failed to fetch") || err.name === "TypeError") {
            console.log("–ü–æ—Ö–æ–∂–µ, –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ü—Ä–æ–±—É–µ–º –∫—ç—à...");

            try {
                const cache = await caches.open(cacheName);
                const cachedResponse = await cache.match(pdfUrl);

                if (cachedResponse) {
                    const blob = await cachedResponse.blob();
                    const url = URL.createObjectURL(blob);
                    window.open(url, '_blank');
                    return;
                } else {
                    alert("–ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ PDF –µ—â—ë –Ω–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω. –ó–∞–π–¥–∏—Ç–µ –æ–Ω–ª–∞–π–Ω –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.");
                    return;
                }
            } catch (cacheErr) {
                alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å PDF –¥–∞–∂–µ –∏–∑ –∫—ç—à–∞.");
                console.error(cacheErr);
                return;
            }
        }

        // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ù–ï —Å–µ—Ç–µ–≤–∞—è ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å PDF: " + err.message);
    }
}

        // ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–∫–ª—é—á–∞—è PDF)
        if ('serviceWorker' in navigator) {
            const swContent = `
                const CACHE_NAME = 'pdf-cache-v1';
                const PDF_URLS = [
                    'https://mephi3.ru/files/education/edu_school/rasp.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_o.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_o_new.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_oz.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_oz_new.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_zach.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_ekz.pdf',
                    'https://mephi3.ru/files/education/edu_higher/rasp_presedach.pdf',
                    'https://mephi3.ru/files/education/edu_secondary/rasp.pdf',
                    'https://mephi3.ru/files/education/edu_secondary/rasp_next.pdf',
                    'https://mephi3.ru/files/education/edu_secondary/rasp_ekz.pdf',
                    'https://mephi3.ru/files/education/edu_secondary/rasp_zach.pdf',
                    'https://mephi3.ru/files/education/edu_secondary/rasp_peresdach.pdf',
                    'https://mephi3.ru/files/education/mifitnes.pdf'
                    // üëà –°–Æ–î–ê –î–û–ë–ê–í–¨ –°–í–û–ò –†–ï–ê–õ–¨–ù–´–ï –°–°–´–õ–ö–ò –ù–ê PDF
                ];

                self.addEventListener('install', event => {
            event.waitUntil(
                caches.open(CACHE_NAME).then(cache => {
                    // –ö—ç—à–∏—Ä—É–µ–º, –Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
                    return Promise.all(
                        PDF_URLS.map(url => {
                            return fetch(url)
                                .then(res => res.ok ? cache.put(url, res) : Promise.resolve())
                                .catch(err => {
                                    console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å:', url, err);
                                });
                        })
                    );
                })
            );
        });

        self.addEventListener('fetch', event => {
            const url = new URL(event.request.url);
            if (PDF_URLS.some(pdfUrl => url.href.startsWith(pdfUrl))) {
                event.respondWith(
                    caches.match(event.request).then(cached => {
                        return cached || fetch(event.request);
                    })
                );
            }
        });
    `;

    const swBlob = new Blob([swContent], { type: 'application/javascript' });
    const swURL = URL.createObjectURL(swBlob);

    navigator.serviceWorker.register(swURL).then(reg => {
        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω (–¥–ª—è PDF)');
    }).catch(err => {
        console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ SW:', err);
    });
}
    </script>
</head>
<body>
    <img src="logo.png" alt="–ú–ò–§–ò-3">
    <br>
    <h1>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h1>

    <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="mainmenu" class="menu-container">
        <h3>–û—Ç–¥–µ–ª–µ–Ω–∏—è</h3>
        <div class="button predun_button" onclick="showpredunmenu()">–ü—Ä–µ–¥—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–∞—Ä–∏–π</div>
        <div class="button spo_button" onclick="showspomenu()">–°—Ä–µ–¥–Ω–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</div>
        <div class="button vo_button_och" onclick="showvoochmenu()">–í—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</div>
        <div class="button vo_button_zaoch" onclick="showvozaochmenu()">–í—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–∑–∞–æ—á–Ω–æ–µ)</div>

        <h3>–û–±—â–µ–µ</h3>
        <div class="button sportzal_button" onclick="openPDF('https://mephi3.ru/files/education/mifitnes.pdf?v=1757326628996')">–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã —Å–ø–æ—Ä—Ç–∑–∞–ª–∞</div>
        <div class="button site_button" onclick="window.location.href='https://mephi3.ru'">–°–∞–π—Ç —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞</div>
        <div class="button info_button" onclick="alert('–í–µ—Ä—Å–∏—è 1.0')">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div>
    </div>

    <!-- –ü–æ–¥–º–µ–Ω—é –¥–ª—è –ü—Ä–µ–¥—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–∞—Ä–∏—è -->
    <div id="predunmenu" class="menu-container" style="display:none;">
        <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–∞—Ä–∏—è</h3>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_school/rasp.pdf')">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤</div>
        <div class="button" onclick="window.location.href='https://net.mephi3.ru'">–°–∏—Å—Ç–µ–º–∞ –°–µ—Ç–µ–≤–æ–π –≥–æ—Ä–æ–¥</div>
        <div class="button" id="backButton" onclick="showMainmenu()">–ù–∞–∑–∞–¥</div>
    </div>
    <div id="spomenu" class="menu-container" style="display:none;">
        <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –°–ü–û</h3>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_secondary/rasp.pdf')">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_secondary/rasp_next.pdf')">–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_secondary/rasp_zach.pdf')">–ó–∞—á—ë—Ç—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_secondary/rasp_ekz.pdf')">–≠–∫–∑–∞–º–µ–Ω—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_secondary/rasp_peresdach.pdf')">–ü–µ—Ä–µ—Å–¥–∞—á–∏</div>
        <div class="button" onclick="window.location.href='https://stud.mephi3.ru'">–ü–ª–∞–Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <div class="button" id="backButton" onclick="showMainmenu()">–ù–∞–∑–∞–¥</div>
    </div>
    <div id="voochmenu" class="menu-container" style="display:none;">
        <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –í–û</h3>
<div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_o.pdf')">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_o_new.pdf')">–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_zach.pdf')">–ó–∞—á—ë—Ç—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_ekz.pdf')">–≠–∫–∑–∞–º–µ–Ω—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_peresdach.pdf')">–ü–µ—Ä–µ—Å–¥–∞—á–∏</div>
        <div class="button" onclick="window.location.href='https://stud.mephi3.ru'">–ü–ª–∞–Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <div class="button" id="backButton" onclick="showMainmenu()">–ù–∞–∑–∞–¥</div>
    </div>
    <div id="vozaochmenu" class="menu-container" style="display:none;">
        <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –í–û (–æ—á–Ω–æ-–∑–∞–æ—á–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ)</h3>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_oz.pdf')">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_oz_new.pdf')">–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_zach.pdf')">–ó–∞—á—ë—Ç—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_ekz.pdf')">–≠–∫–∑–∞–º–µ–Ω—ã</div>
        <div class="button" onclick="openPDF('https://mephi3.ru/files/education/edu_higher/rasp_peresdach.pdf')">–ü–µ—Ä–µ—Å–¥–∞—á–∏</div>
        <div class="button" onclick="window.location.href='https://stud.mephi3.ru'">–ü–ª–∞–Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <div class="button" id="backButton" onclick="showMainmenu()">–ù–∞–∑–∞–¥</div>
    </div>


</body>
</html>